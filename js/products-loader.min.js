const ProductsLoader={products:[],categories:new Set,async init(){try{const t=await fetch("products.json");this.products=await t.json(),this.extractCategories(),console.log(`‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${this.products.length} —Ç–æ–≤–∞—Ä–æ–≤`)}catch(t){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤:",t)}},extractCategories(){this.products.forEach(t=>this.categories.add(t.category))},getByCategory(t){return t&&"all"!==t?this.products.filter(r=>r.category===t):this.products},getPopular(t=6){const r=[],e=new Set;for(const o of this.products)!e.has(o.category)&&r.length<t&&(r.push(o),e.add(o.category));if(r.length<t)for(const e of this.products)!r.includes(e)&&r.length<t&&r.push(e);return r},getCategoryIcon:t=>({"–®—Ç—É–∫–∞—Ç—É—Ä–∫–∏":"üèóÔ∏è","–®–ø–∞—Ç–ª–µ–≤–∫–∏":"üé®","–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —à–ø–∞—Ç–ª–µ–≤–∫–∏":"‚ú®","–ö—Ä–∞—Å–∫–∏":"üñåÔ∏è","–ì—Ä—É–Ω—Ç—ã":"üß™","–ü–ª–∏—Ç–æ—á–Ω—ã–µ –∫–ª–µ–∏":"üß±","–ì–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è":"üíß"}[t]||"üì¶"),formatPrice:t=>parseFloat(t).toLocaleString("ru-RU",{minimumFractionDigits:0,maximumFractionDigits:0}),renderCard(t){const r=this.formatPrice(t.price),e=this.getCategoryIcon(t.category);return`\n            <article class="product-card" data-article="${t.article}">\n                <div class="product-image">\n                    ${e}\n                </div>\n                <div class="product-body">\n                    <div class="product-category">${t.category}</div>\n                    <h3 class="product-name">${t.name}</h3>\n                    <div class="product-footer">\n                        <div class="product-price">${r} <span>‚ÇΩ</span></div>\n                        <a href="mailto:olnast.ru@yandex.ru?subject=–ó–∞—è–≤–∫–∞: ${encodeURIComponent(t.name)}&body=–¢–æ–≤–∞—Ä: ${encodeURIComponent(t.name)}%0A–¶–µ–Ω–∞: ${r} ‚ÇΩ%0A–ê—Ä—Ç–∏–∫—É–ª: ${t.article}%0A%0A–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:" \n                           class="btn btn-primary btn-sm">\n                            –ó–∞–∫–∞–∑–∞—Ç—å\n                        </a>\n                    </div>\n                </div>\n            </article>\n        `},renderFullCard(t){const r=this.formatPrice(t.price),e=this.getCategoryIcon(t.category),o=t.description.replace(/&nbsp;/g," ").replace(/<[^>]*>/g,"").trim();return`\n            <article class="product-card product-card-full" data-article="${t.article}">\n                <div class="product-image">\n                    ${e}\n                </div>\n                <div class="product-body">\n                    <div class="product-category">${t.category}</div>\n                    <h3 class="product-name">${t.name}</h3>\n                    <p class="product-desc">${o}</p>\n                    <div class="product-footer">\n                        <div class="product-price">${r} <span>‚ÇΩ</span></div>\n                        <a href="mailto:olnast.ru@yandex.ru?subject=–ó–∞—è–≤–∫–∞: ${encodeURIComponent(t.name)}&body=–¢–æ–≤–∞—Ä: ${encodeURIComponent(t.name)}%0A–¶–µ–Ω–∞: ${r} ‚ÇΩ%0A–ê—Ä—Ç–∏–∫—É–ª: ${t.article}%0A%0A–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:" \n                           class="btn btn-primary">\n                            –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É\n                        </a>\n                    </div>\n                </div>\n            </article>\n        `},renderGrid(t,r,e=!1){if(!r)return;const o=t.map(t=>e?this.renderFullCard(t):this.renderCard(t)).join("");r.innerHTML=o},renderCatalog(t=!0){const r=document.getElementById("products-grid");r&&this.renderGrid(this.products,r,t)},renderPopular(){const t=document.getElementById("popular-products");if(!t)return;const r=this.getPopular(6);this.renderGrid(r,t,!1)},filterByCategory(t){const r=document.getElementById("products-grid");if(!r)return;const e=this.getByCategory(t);this.renderGrid(e,r,!0),document.querySelectorAll("[data-category]").forEach(r=>{r.classList.toggle("active",r.dataset.category===t)})},renderCategoryFilters(t="category-filters"){const r=document.getElementById(t);if(!r)return;const e=["all",...Array.from(this.categories)],o={all:"–í—Å–µ —Ç–æ–≤–∞—Ä—ã","–®—Ç—É–∫–∞—Ç—É—Ä–∫–∏":"–®—Ç—É–∫–∞—Ç—É—Ä–∫–∏","–®–ø–∞—Ç–ª–µ–≤–∫–∏":"–®–ø–∞—Ç–ª–µ–≤–∫–∏","–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —à–ø–∞—Ç–ª–µ–≤–∫–∏":"–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ","–ö—Ä–∞—Å–∫–∏":"–ö—Ä–∞—Å–∫–∏","–ì—Ä—É–Ω—Ç—ã":"–ì—Ä—É–Ω—Ç—ã","–ü–ª–∏—Ç–æ—á–Ω—ã–µ –∫–ª–µ–∏":"–ö–ª–µ–∏","–ì–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è":"–ì–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è"};r.innerHTML=e.map(t=>`\n            <button \n                class="filter-btn ${"all"===t?"active":""}" \n                data-category="${t}"\n                onclick="ProductsLoader.filterByCategory('${t}')"\n            >\n                ${o[t]||t}\n            </button>\n        `).join("")}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{ProductsLoader.init().then(()=>{ProductsLoader.renderCatalog(),ProductsLoader.renderPopular(),ProductsLoader.renderCategoryFilters()})}):ProductsLoader.init().then(()=>{ProductsLoader.renderCatalog(),ProductsLoader.renderPopular(),ProductsLoader.renderCategoryFilters()});